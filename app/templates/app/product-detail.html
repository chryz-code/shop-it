{% extends 'app/store-nav.html' %} {% load static %}{% block title %}<title>
  Shop !t - {{product.created_by}} {{product.name}}
</title>
{% endblock %} {% block content %}

<div class="product-container">
  <div class="carousel">
    <button class="carousel__button carousel__button--left is-hidden">
      <img src="{% static 'images/icons/arrow-left-solid.svg' %}" alt="" />
    </button>
    <div class="carousel__track-container">
      <ul class="carousel__track">
        {% if product.image_1 %}
        <li class="carousel__slide currentSlide">
          <img class="carousel__image" src="{{product.image_1.url}}" alt="" />
        </li>
        {% endif %} {% if product.image_2 %}
        <li class="carousel__slide">
          <img class="carousel__image" src="{{product.image_2.url}}" alt="" />
        </li>
        {% endif %} {% if product.image_3 %}
        <li class="carousel__slide">
          <img class="carousel__image" src="{{product.image_3.url}}" alt="" />
        </li>
        {% endif %} {% if product.image_4 %}
        <li class="carousel__slide">
          <img class="carousel__image" src="{{product.image_4.url}}" alt="" />
        </li>
        {% endif %}
      </ul>
    </div>
    <button class="carousel__button carousel__button--right">
      <img src="{% static 'images/icons/arrow-right-solid.svg' %}" alt="" />
    </button>

    <div class="carousel__nav">
      {% if product.image_1 %}
      <button class="carousel__indicator current-slide"></button>
      {% endif %} {% if product.image_2 %}
      <button class="carousel__indicator"></button>
      {% endif %} {% if product.image_3 %}
      <button class="carousel__indicator"></button>
      {% endif %} {% if product.image_4 %}
      <button class="carousel__indicator"></button>
      {% endif %}
    </div>
  </div>

  <div class="product-info">
    
      <h1>{{ product.name }}</h1>
      <p>{{product.category}}</p>
      <a href="">{{product.created_by}}</a>
      <p>{{product.price}}</p>
      <p>Availability: {{product.availability}}</p>
      <div>{{product.description}}</div>
      {% if product.availability > 0 %}
      <select id="select">
        <div class="list">
          <option value="0">0</option>
          <option value="1">1</option>
           {% if product.availability > 2 %}
          <option value="2">2</option>
          {% endif %} {% if product.availability > 3 %}
          <option value="3">3</option>
          {% endif %} {% if product.availability > 4 %}
          <option value="4">4</option>
          {% endif %} {% if product.availability > 5 %}
          <option value="5">5</option>
          {% endif %}
        </div>
      </select>
  
    <button type="button" id="add-to-cart-btn" value="{{product.id}}" class="update-cart-btn">Add to cart</button>
    {% else %}
    <button type="button" id="add-to-cart-btn" value="{{product.id}}" class="update-cart-btn out-of-stock">Out of stock</button>
    {% endif %}
      <p>Review</p>
    </div>
  </div>
</div>
{% if category_product %}
<div>You might also like</div>
{% for product in category_product %}
  <div>
    {{ product.name }}
  </div>
  {% endfor %}
{% endif %}

{% include 'app/footer.html' %}
<script>
  $(document).on("click", "#add-to-cart-btn", function (e) {
    $.ajax({
      type: "POST",
      url: "{% url 'cart:add_to_cart' %}",
      data: {
        productid: $("#add-to-cart-btn").val(),
        productqty: $("#select option:selected").text(),
        csrfmiddlewaretoken: "{{ csrf_token }}",
        action: "post",
      },
      success: function (json) {
        console.log(json)
        document.getElementById("product-cart-qty").innerHTML = json.qty
      },
      error: function (xhr, errmsg, err) {},
    });
  });
</script>
{% endblock %}
